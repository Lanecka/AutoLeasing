const priceFormatter=new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",maximumFractionDigits:0});let rangePrice=document.querySelector("#rangePrice"),rangePayment=document.querySelector("#rangePayment"),perPayment=document.querySelector("#perPayment"),rangeTerm=document.querySelector("#rangeTerm"),summa=document.querySelector("#suma"),monthly=document.querySelector("#monthly"),form=document.querySelector("#form");const cleaveValSet={numeral:!0,numeralThousandsGroupStyle:"thousand",delimiter:" "},cleavePrice=new Cleave(rangePrice,cleaveValSet),cleavePayment=new Cleave(rangePayment,cleaveValSet),cleaveTerm=new Cleave(rangeTerm,cleaveValSet),maxPrice=1e7,maxPayment=.6*+cleavePrice.getRawValue(),maxTerm=120;function rent(){let e=+cleavePrice.getRawValue(),r=(e>maxPrice&&(e=maxPrice),+cleavePayment.getRawValue()),a=(r>maxPayment&&(r=maxPayment),+cleaveTerm.getRawValue());120<a&&(a=maxTerm);var n=e-r,t=.14*n/12,n=n*t/(1-(1+t)*(1-a)),t=(monthly.innerHTML=priceFormatter.format(n),n*a+r);summa.innerHTML=priceFormatter.format(t),perPayment.innerHTML=Math.ceil(100*r/e)+" %"}rent(),form.addEventListener("input",function(){rent()});const sliderPrice=document.querySelector("#sliderPrice"),sliderPay=(noUiSlider.create(sliderPrice,{start:33e5,connect:"lower",tooltips:!1,step:1e3,range:{min:15e5,max:1e7},format:wNumb({decimals:0,thousand:" ",suffix:""})}),sliderPrice.noUiSlider.on("slide",function(){var e=parseInt(sliderPrice.noUiSlider.get(!0));rangePrice.value=e,cleavePrice.setRawValue(e),rent()}),document.querySelector("#sliderPay")),sliderTerm=(noUiSlider.create(sliderPay,{start:42e4,connect:"lower",tooltips:!1,step:1e3,range:{min:1e5,max:maxPayment},format:wNumb({decimals:0,thousand:" ",suffix:""})}),sliderPay.noUiSlider.on("slide",function(){var e=parseInt(sliderPay.noUiSlider.get(!0));rangePayment.value=e,cleavePayment.setRawValue(e),rent()}),document.querySelector("#sliderTerm"));noUiSlider.create(sliderTerm,{start:60,connect:"lower",tooltips:!0,step:1,range:{min:6,max:120},format:wNumb({decimals:0,thousand:"",suffix:""})}),sliderTerm.noUiSlider.on("slide",function(){var e=parseInt(sliderTerm.noUiSlider.get(!0));rangeTerm.value=e,cleaveTerm.setRawValue(e),rent()}),rangePrice.addEventListener("input",function(){var e=+cleavePrice.getRawValue(),r=(sliderPrice.noUiSlider.set(e),1e7<e?rangePrice.closest(".item__meaning").classList.add("item__meaning--error"):rangePrice.closest(".item__meaning").classList.remove("item__meaning--error"),.1*e),e=.6*e;sliderPay.noUiSlider.updateOptions({range:{min:r,max:e}})}),rangePrice.addEventListener("change",function(){+cleavePrice.getRawValue()>maxPrice&&(rangePrice.closest(".item__meaning").classList.remove("item__meaning--error"),cleavePrice.setRawValue(maxPrice))}),rangePayment.addEventListener("input",function(){var e=+cleavePayment.getRawValue();sliderPay.noUiSlider.set(e),e>maxPayment?rangePayment.closest(".item__meaning").classList.add("item__meaning--error"):rangePayment.closest(".item__meaning").classList.remove("item__meaning--error")}),rangePayment.addEventListener("change",function(){+cleavePayment.getRawValue()>maxPayment&&(rangePayment.closest(".item__meaning").classList.remove("item__meaning--error"),cleavePayment.setRawValue(maxPayment))}),rangeTerm.addEventListener("input",function(){var e=+cleaveTerm.getRawValue();sliderTerm.noUiSlider.set(e),e>maxTerm?rangeTerm.closest(".item__meaning").classList.add("item__meaning--error"):rangeTerm.closest(".item__meaning").classList.remove("item__meaning--error")}),rangeTerm.addEventListener("change",function(){+cleaveTerm.getRawValue()>maxTerm&&(rangeTerm.closest(".item__meaning").classList.remove("item__meaning--error"),cleaveTerm.setRawValue(maxTerm))});